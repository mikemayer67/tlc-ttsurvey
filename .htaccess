Options All -Indexes

<If "%{SERVER_NAME} =~ /^localhost$/">
  ErrorDocument 403 /tlc-ttsurvey/404.php
  ErrorDocument 404 /tlc-ttsurvey/404.php
</If>
<Else>
  ErrorDocument 403 /404.php
  ErrorDocument 404 /404.php
</Else>

<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{REQUEST_URI} ^/([^/]+)/
RewriteRule .* - [E=BASE_DIR:/%1]
RewriteCond %{REQUEST_FILENAME} !-f [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule . %{ENV:BASE_DIR}/index.php [L]
</IfModule>

<FilesMatch "^\.">
  Deny from all
</FilesMatch>

<FilesMatch "~$">
  Deny from all
</FilesMatch>

<FilesMatch "\.(php|sql)$">
  Order deny,allow
  Deny from all
</FilesMatch>

<FilesMatch '(index|4\d\d).php$'>
  Order deny,allow
  Allow from all
</FilesMatch>
